<?xml version="1.0" encoding="utf-8"?>

<!--
  ~ R3 Proprietary and Confidential
  ~
  ~ Copyright (c) 2018 R3 Limited.  All rights reserved.
  ~
  ~ The intellectual and technical concepts contained herein are proprietary to R3 and its suppliers and are protected by trade secret law.
  ~
  ~ Distribution of this file or any portion thereof via any medium without the express permission of R3 is strictly prohibited.
  -->

<restrict>
    <http>
        <method>post</method>
        <method>get</method>
    </http>

    <commands>
        <command>read</command>
        <command>list</command>
    </commands>

    <!-- allow anyone to force a garbage collection -->
    <allow>
        <mbean>
            <name>java.lang:type=Memory</name>
            <operation>gc</operation>
        </mbean>
    </allow>

    <!-- in case we ever end up using c3pio connection pooling, this example from the docs prevents the password being exported -->
    <deny>
        <mbean>
            <name>com.mchange.v2.c3p0:type=PooledDataSource,*</name>
            <attribute>properties</attribute>
        </mbean>
    </deny>

</restrict>